<!DOCTYPE html>
<html ng-app="demo">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="/style/button.css">
  <link rel="stylesheet" href="/style/demo.css">

  <script src="/angular/angular.js" type="text/javascript" charset="utf-8"></script>

  <script src="/util.js" type="text/javascript" charset="utf-8"></script>
  <script src="/proxy.js" type="text/javascript" charset="utf-8"></script>
  <script src="/options.js" type="text/javascript" charset="utf-8"></script>
  <script src="/group.js" type="text/javascript" charset="utf-8"></script>
  <script src="/control.js" type="text/javascript" charset="utf-8"></script>
  <script src="/event.js" type="text/javascript" charset="utf-8"></script>
  <script src="/init.js" type="text/javascript" charset="utf-8"></script>
  <script src="/status.js" type="text/javascript" charset="utf-8"></script>
  <script src="/cloak.js" type="text/javascript" charset="utf-8"></script>
  <script src="/public.js" type="text/javascript" charset="utf-8"></script>
  
</head>
<body ng-controller="demoCtrl">

<!--   <button type="button" class="btn btn-inside" q-click="btnC()">inside btn </button>
  <div class="btn-outside-group">
    <button type="button" class="btn" q-click="btnC()">outside btn group</button>
  </div> -->


  <div q-init="btnC()" q-group ng-cloak>
    <div q-status >
      <h3 q-status-loading>loading</h3>
      <h3 q-status-failed> failed</h3>
    </div>
    <div class="" q-cloak>
      xxxxxxxx
    </div>
  </div>

  <script type="text/javascript" charset="utf-8">
  angular.module('demo',['ng','ng-loading']).controller('demoCtrl', ['$q','$scope','$timeout','PromiseProxy',function ($q,$scope,$timeout,PromiseProxy) {
      var i = 0;
      function makePromise(deferred,resolve,value){
        console.log('make promise',resolve)
        if (resolve)
          deferred.resolve(value)
        else 
          deferred.reject(value)
      }
      $scope.btnC = function(){
        var deferred = $q.defer()
        var promise = deferred.promise
        i = (i%2) + 1;
        if(i%2 === 0 ){
          $timeout(function(){
            makePromise(deferred,true)
          },5000)
        }else {
          $timeout(function(){
            makePromise(deferred,false)
          },5000)
        }
        return promise
      }
  }])
  </script>

  <script src="//localhost:35729/livereload.js"></script>
</body>
</html>